name: Actions Runner Controller Demo
on:
  workflow_dispatch:
  push:

jobs:
  Explore-GitHub-Actions:
    runs-on: arc-runner-set-uchicago
    steps:
      - run: echo "ðŸŽ‰ This job uses runner scale set runners!"

      - name: Checkout repo
        uses: actions/checkout@v5

      - name: Install libcrypt.so.2
        run: |
          sudo apt-get update || true
          sudo apt-get install -y libxcrypt0 || true
          sudo apt-get install -y libcrypt1  || true
          CANDIDATE=$(ls /usr/lib/x86_64-linux-gnu/libcrypt.so.* 2>/dev/null | head -n 1 || true)
          if [ -n "$CANDIDATE" ] && [ ! -f /usr/lib/x86_64-linux-gnu/libcrypt.so.2 ]; then
            echo "Using $CANDIDATE as libcrypt.so.2"
            sudo ln -s "$CANDIDATE" /usr/lib/x86_64-linux-gnu/libcrypt.so.2
          fi
          ls -l /usr/lib/x86_64-linux-gnu/libcrypt.so*

      - name: EVNT-EL9
        run: ./EVNT/UC/EL9/run_evnt_el9_batch.sh
        working-directory: .
        shell: bash

        # See https://github.com/orgs/community/discussions/45415
      - name: Upload log.generate
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: evnt-logs
          path: |
            log.generate

      - name: EVNT-CentOS7
        run: ./EVNT/UC/CentOS7/run_evnt_centos7_batch.sh
        working-directory: .
        shell: bash

        # See https://github.com/orgs/community/discussions/45415
      - name: Upload log.generate
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: evnt-logs
          path: |
            log.generate
